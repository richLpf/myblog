(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{486:function(s,n,a){"use strict";a.r(n);var t=a(30),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("这一节，我们继续对项目进行改造，引入数据库，配置，文档等。")]),s._v(" "),a("h2",{attrs:{id:"一、引入数据库交互"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、引入数据库交互"}},[s._v("#")]),s._v(" 一、引入数据库交互")]),s._v(" "),a("p",[s._v("这里我们引入mysql,使用了gorm，操作数据库")]),s._v(" "),a("p",[s._v("新建"),a("code",[s._v("dbs/mysql.go")]),s._v(" 文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package dbs\n\nimport (\n\t"fmt"\n\t"time"\n\n\t"github.com/jinzhu/gorm"\n\t//mysql driver\n\t_ "github.com/jinzhu/gorm/dialects/mysql"\n)\n\nvar (\n\t//DB 数据库\n\tDB  *gorm.DB\n\terr error\n)\n\n//User 用户表\ntype User struct {\n\tID        int       `gorm:"primary_key" json:"id"`\n\tUsername  string    `json:"Username"`\n\tPassword  string    `json:"Password"`\n\tCreatedBy string    `json:"created_by"`\n\tUpdatedAt time.Time `json:"updated_at"`\n\tCreatedAt time.Time `json:"created_at"`\n\tIsDeleted uint      `json:"is_deleted"`\n}\n\nfunc init() {\n\t//本地启动了3306的数据库\n\tDB, err = gorm.Open("mysql", "root:123456@tcp(localhost:3306)/web?charset=utf8&parseTime=True&loc=Local")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tDB.SingularTable(true)                                             // 创建表不会默认变成复数\n\tDB.Set("gorm:table_options", "ENGINE=InnoDB").AutoMigrate(&User{}) //自动迁移数据库\n\tfmt.Println("db", DB)\n\tDB.DB().Ping()\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("我们将连接数据库操作的方法放在init中，启动服务时，会首先尝试连接数据库。除了连接数据库，这里增加了自动迁移数据库，不用再一个个创建，只要写好模型，就可以自动生成数据表。")]),s._v(" "),a("p",[s._v("此时main.go变成了"),a("code",[s._v("cat main.go")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package main\n\nimport (\n\t_ "myapp/dbs"\n\t"myapp/router"\n)\n\nfunc main() {\n\tapiRouter := router.Router()\n\tapiRouter.Run(":9000")\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("这里仅仅增加了 "),a("code",[s._v('_ "myapp/dbs"')]),s._v(" 因为仅仅需要调用dbs包的init方法，会自动执行")]),s._v(" "),a("p",[s._v("这样我们就可以和数据库进行数据交互，")]),s._v(" "),a("p",[s._v("（1）但如果有很多表的话，岂不是要这个文件很大，我们创建model包，将所有的model统一管理，需要的时候调用就可以了。")]),s._v(" "),a("p",[s._v("（2）实际开发项目中，常常有多个环境，通常最少要有开发环境和生产环境，那么我们每次都需要去改数据库连接的代码，明显不合理的。所有我们接着引入下面的配置文件")]),s._v(" "),a("h2",{attrs:{id:"二、引入ini配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、引入ini配置文件"}},[s._v("#")]),s._v(" 二、引入ini配置文件")]),s._v(" "),a("p",[s._v("这里我使用的配置文件是ini，其他的也是一样的")]),s._v(" "),a("p",[s._v("新建config文件夹，文件夹下新增"),a("code",[s._v("config.go")]),s._v(" "),a("code",[s._v("dev.ini")]),s._v(" "),a("code",[s._v("prod.ini")])]),s._v(" "),a("p",[a("code",[s._v("cat config.go")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package config\n\nimport (\n\t"gopkg.in/ini.v1"\n)\n\n//App 参数\ntype App struct {\n\tMode string\n\tPort string\n}\n\n//Mysql 参数\ntype Mysql struct {\n\tUser     string\n\tHost     string\n\tPort     string\n\tPassword string\n\tDatabase string\n}\n\n//IniParser struct\ntype IniParser struct {\n\tconfReader *ini.File\n}\n\n//IniParseError struct\ntype IniParseError struct {\n\terrorInfo string\n}\n\nfunc (e *IniParseError) Error() string { return e.errorInfo }\n\n//Load read ini\nfunc (s *IniParser) Load(configFileName string) error {\n\tconf, err := ini.Load(configFileName)\n\tif err != nil {\n\t\ts.confReader = nil\n\t\treturn err\n\t}\n\ts.confReader = conf\n\treturn nil\n}\n\n//GetString ini string\nfunc (s *IniParser) GetString(section string, key string) string {\n\tif s.confReader == nil {\n\t\treturn ""\n\t}\n\tr := s.confReader.Section(section)\n\tif r == nil {\n\t\treturn ""\n\t}\n\treturn r.Key(key).String()\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br")])]),a("p",[a("code",[s._v("cat dev.ini")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[app]\nmode = "dev"\nport = ":9000"\n\n[mysql]\nuser = "root"\nhost = "localhost"\nport = "3306"\npassword = "123456"\ndatabase = "web"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("这个是配置文件，不同的服务环境")]),s._v(" "),a("p",[s._v("接着我们新建 "),a("code",[s._v("application")]),s._v(" 夹，在这个包中判断服务的环境，并判断需要选择哪个环境")]),s._v(" "),a("p",[a("code",[s._v("cat run.go")]),s._v(" 其中分别获取了服务的配置信息和数据库的配置信息，")]),s._v(" "),a("p",[s._v("在Run函数中，判断当前环境，如果是生产环境，则读取prod.ini")]),s._v(" "),a("p",[s._v("如果是开发环境则读取dev.ini配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package application\n\nimport (\n\t"flag"\n\t"fmt"\n\t"myapp/config"\n\t"myapp/dbs"\n\tapiRouter "myapp/router"\n\t"os"\n)\n\n//Run 启动app\nfunc Run() {\n\tmode := flag.String("mode", "dev", "eventment")\n\tflag.Parse()\n\tmysql, err := getMysql(*mode)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdbs.RunMysql(mysql)\n\tapp, err := getApp(*mode)\n\tfmt.Println("app", app)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\trouter := apiRouter.Router(app)\n\trouter.Run(app.Port)\n}\n\nfunc readIni(mode string) (iniParser config.IniParser, err error) {\n\tconfFileName := "dev.ini"\n\tif mode == "prod" {\n\t\tconfFileName = "prod.ini"\n\t}\n\t//iniParser = conf.IniParser{}\n\tdir, _ := os.Getwd()\n\tpathName := dir + `/config/` + confFileName\n\terr = iniParser.Load(pathName)\n\treturn iniParser, err\n}\n\nfunc getApp(mode string) (app config.App, err error) {\n\tiniParser, err := readIni(mode)\n\tif err != nil {\n\t\treturn app, err\n\t}\n\tapp = config.App{\n\t\tMode: mode,\n\t\tPort: iniParser.GetString("app", "port"),\n\t}\n\treturn app, nil\n}\n\nfunc getMysql(mode string) (mysql config.Mysql, err error) {\n\tiniParser, err := readIni(mode)\n\tif err != nil {\n\t\treturn mysql, err\n\t}\n\tmysql = config.Mysql{\n\t\tUser:     iniParser.GetString("mysql", "user"),\n\t\tPassword: iniParser.GetString("mysql", "password"),\n\t\tHost:     iniParser.GetString("mysql", "host"),\n\t\tPort:     iniParser.GetString("mysql", "port"),\n\t\tDatabase: iniParser.GetString("mysql", "database"),\n\t}\n\treturn mysql, err\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br")])]),a("h2",{attrs:{id:"三、引入swagger文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、引入swagger文档"}},[s._v("#")]),s._v(" 三、引入swagger文档")]),s._v(" "),a("p",[s._v("在router中引入swagger "),a("code",[s._v("cat swagger")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package router\n\nimport (\n\t"myapp/config"\n\t"myapp/controller/passage"\n\t"myapp/controller/user"\n\t"myapp/middleware"\n\n\t//docs\n\t_ "myapp/docs"\n\n\t"github.com/gin-gonic/gin"\n\tswaggerFiles "github.com/swaggo/files"\n\tginSwagger "github.com/swaggo/gin-swagger"\n)\n\n//Router 路由\nfunc Router(app config.App) *gin.Engine {\n\trouter := gin.New()\n\t// 使用中间件\n\t// 使用Logger中间件\n\trouter.Use(gin.Logger())\n\t// 使用Recovery中间件\n\trouter.Use(gin.Recovery())\n\n\tif app.Mode == "prod" {\n\t\tgin.SetMode(gin.ReleaseMode)\n\t}\n\trouter.Use(middleware.Cors())\n\n\trouter.GET("/swagger/*any", ginSwagger.WrapHandler(swaggerFiles.Handler))\n\tuserRouter := router.Group("/user")\n\tuserRouter.GET("list", user.GetUserList)\n\tuserRouter.GET("detail/:id", user.GetDetail)\n\n\tpassageRouter := router.Group("/passage")\n\tpassageRouter.GET("list", passage.GetPassageList)\n\tpassageRouter.POST("add", passage.AddPassage)\n\n\treturn router\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("p",[a("code",[s._v("cat main.go")]),s._v("\n在main.go中，通过下面的注释，来生成文档")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package main\n\nimport (\n\t"myapp/application"\n)\n\n// @title Swagger Example API\n// @version 1.0\n// @description This is a sample server Petstore server.\n\n// @contact.name API Support\n// @contact.url http://www.swagger.io/support\n// @contact.email support@swagger.io\n\n// @host localhost:9000\n// @BasePath /\nfunc main() {\n\tapplication.Run()\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("在controller文件下，passage.go中，添加注释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package passage\n\nimport (\n\t"net/http"\n\n\t"github.com/gin-gonic/gin"\n)\n\n//GetPassageList get passage\n// List godoc\n// @Summary 列表实例\n// @Description 描述信息\n// @Tags 类别\n// @Accept json\n// @Produce json\n// @Param limit query string false  "20"\n// @Param offset query string false  "0"\n// @Success 200 {string} string "ok"\n// @Router /ucloud/list [get]\nfunc GetPassageList(c *gin.Context) {\n\tc.JSON(http.StatusOK, gin.H{"RetCode": 0, "Msg": "success"})\n}\n\n// AddPassage update passage\n// AddUser godoc\n// @Summary 添加文章\n// @Description 添加文章\n// @Tags 类别\n// @Accept json\n// @Produce json\n// @Param body body model.Passage true  "请求参数"\n// @Success 200 {string} string "ok"\n// @Router /passage/add [post]\nfunc AddPassage(c *gin.Context) {\n\tc.JSON(http.StatusOK, gin.H{"RetCode": 0, "Msg": "success"})\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("执行命令行 "),a("code",[s._v("swag init")]),s._v("  会生成docs文件夹")]),s._v(" "),a("p",[s._v("当前目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("|-application             服务相关的逻辑\n|   |--run.go\n|-common                  公用函数\n|   |--utils.go\n|   |--request.go\n|-config                  配置\n|-dbs                     加载数据库\n|-docs                    swagger生成文档\n|-middleware              中间件\n|-model                   模型\n|-controller              控制器\n|   |--user               用户相关接口\n|     |--user.go\n|   |--passage            文章相关接口\n|     |--passage.go\n|-router                  路由文件\n|   |--router.go  \n|—go.mod                  mod管理器\n|—go.sum                  自动生成记录包的版本\n|—main.go                 main包，入口文件\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("打开"),a("code",[s._v("http://localhost:9000/swagger/index.html")]),s._v(" 即可看到接口文档")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://weblpf.cn-bj.ufileos.com/ufile-log%2Fweblpf%2Fswagger.png",alt:"swagger文档"}})])])}),[],!1,null,null,null);n.default=e.exports}}]);